---
title: "MSAN 601 Case Study"
author: "Alvira Swalin, Kunal Kotian, Sooraj Subrahmannian, Vinay Patlolla"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: pdf_document
---

```{r setup, include = FALSE, echo = TRUE}
# Prevent comments from running off the page (force line-wrapping for comments)
knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 70), tidy = TRUE)
```


```{r message=F}
# Load required packages
library(tidyverse)
library(magrittr)
library(glmnet)
library(ISLR)
```

# Cleaning the Dataset

```{r}
# Load housing data
housing <- read.csv('housing.txt', stringsAsFactors = FALSE)
housing <- tbl_df(housing)
```

-----------------------------------------------------------
Vinay


```{r}
na_count <- colSums(is.na(housing))/nrow(housing)
knitr::kable(sort(na_count[na_count > 0], decreasing = T), 
             caption = "Ratio of NAs before cleaning")
```

##Cleaning Data

```{r}
housing$PoolQC[is.na(housing$PoolQC)] <- 'No Pool'
housing$Alley[is.na(housing$Alley)] <- 'No Alley'
housing$MiscFeature[is.na(housing$MiscFeature)] <- 'None'
housing$Fence[is.na(housing$Fence)] <- 'No Fence'
housing$FireplaceQu[is.na(housing$FireplaceQu)] <- 'No Fireplace'
#housing$LotFrontage[is.na(housing$LotFrontage)] <- 'No Lot'
housing$GarageType[is.na(housing$GarageType)] <- 'No Garage'
#housing$GarageYrBlt[is.na(housing$GarageYrBlt)] <- 'No Garage'
#housing$GarageFinish[is.na(housing$GarageFinish)] <- 'No Garage'
housing$GarageQual[is.na(housing$GarageQual)] <- 'No Garage'
housing$GarageCond[is.na(housing$GarageCond)] <- 'No Garage'
housing$BsmtExposure[is.na(housing$BsmtExposure)] <- 'No Basement'
housing$BsmtQual[is.na(housing$BsmtQual)] <- 'No Basement'
housing$BsmtCond[is.na(housing$BsmtCond)] <- 'No Basement'
housing$BsmtFinType1[is.na(housing$BsmtFinType1)] <- 'No Basement'
housing$BsmtFinType2[is.na(housing$BsmtFinType2)] <- 'No Basement'
housing$MasVnrType[is.na(housing$MasVnrType)] <- 'Missing Masonry Veneer'
housing$Electrical[is.na(housing$Electrical)] <- 'Missing Electrical'
```

```{r}
na_count <- colSums(is.na(housing))/nrow(housing)
knitr::kable(sort(na_count[na_count > 0], decreasing = T), 
             caption = "Ratio of NAs after cleaning")

```

```{r}
## Convert character columns to factors
housing_imputed <- as.data.frame(unclass(housing))
## Removing the data which has no year built
housing_imputed <- housing_imputed[!is.na(housing_imputed$GarageYrBlt), ]
```

-----------------------------------------------------------
Alvira



```{r}
grid.lambda <- 10^seq(10, -2, length = 100)
housing = na.omit(housing)
housing = housing[,c(-1,-10)]
x = model.matrix(SalePrice ~.,housing)[,-1]
y = housing$SalePrice
ridge.model <- glmnet(x, y, alpha = 1, lambda = grid.lambda)
plot(ridge.model)
cf = coef(ridge.model)


train <- sample(1:nrow(x), nrow(x) / 2)
test <- (-train)
y.train <- y[train]
y.test <- y[test]
ridge.model.train <- glmnet(x[train, ], y.train, alpha = 1, lambda = grid.lambda)
cv.out <- cv.glmnet(x[train, ], y.train, alpha = 1)
best.lambda <- cv.out$lambda.min
plot(cv.out)
abline(v = log(best.lambda), col = "blue", lwd = 2)
```









